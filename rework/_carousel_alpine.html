<div class="relative" data-aos="fade-up" x-data="{
  currentIndex: 0,
  cardWidth: 0,
  isMobile: window.innerWidth < 768,
  totalCards: 0,
  init() {
    this.updateCardWidth();
    this.updateTotalCards();
    window.addEventListener('resize', () => {
      const wasMobile = this.isMobile;
      this.isMobile = window.innerWidth < 768;

      if (wasMobile !== this.isMobile) {
        this.currentIndex = 0;
      }

      this.updateCardWidth();
      this.updateTotalCards();
      this.slideToIndex(this.currentIndex);
    });
  },
  updateTotalCards() {
    this.totalCards = this.$refs.cardsTrack.children.length;
  },
  updateCardWidth() {
    const card = this.$refs.cardsTrack.children[0];
    if (card) {
      const gap = this.isMobile ? 16 : 32;
      this.cardWidth = card.offsetWidth + gap;
    }
  },
  slideToIndex(index) {
    const maxIndex = this.isMobile ? this.totalCards - 1 : this.totalCards - 2;
    this.currentIndex = Math.max(0, Math.min(index, maxIndex));
    const translateX = -this.currentIndex * this.cardWidth;
    this.$refs.cardsTrack.style.transform = `translateX(${translateX}px)`;
  },
  next() {
    this.slideToIndex(this.currentIndex + 1);
  },
  prev() {
    this.slideToIndex(this.currentIndex - 1);
  }
}">
  <div class="overflow-hidden -mx-4">
    <div class="flex transition-transform duration-500 ease-in-out gap-4 md:gap-8 px-4" x-ref="cardsTrack">

      <div class="flex-none w-full md:w-[calc(50%-1rem)] rounded-lg p-4 md:p-8" style="background: linear-gradient(255.53deg, #07213B 8.04%, #08225A 89.86%);">
        <div class="space-y-8">
          <img src="/assets/images/projects/astreinte-vitale-logo.svg" class="h-[76px] w-auto" alt="Logo de la startup Astreinte Vitale">

          <div class="flex flex-wrap gap-2">
            <span class="bg-[#E11D48] text-white px-3 py-1 rounded-full text-sm">SaaS</span>
            <span class="bg-[#E11D48] text-white px-3 py-1 rounded-full text-sm">HealthTech</span>
            <span class="bg-[#E11D48] text-white px-3 py-1 rounded-full text-sm">Coordination urgences</span>
          </div>

          <p class="text-white leading-6">
            Centralise la logistique de toutes les opérations exceptionnelles pour les <strong>services de soins</strong> en milieu hospitalier, afin d'améliorer la qualité de vie du personnel soignant et leur permettre de se concentrer sur leur cœur de métier : sauver des vies.
          </p>

          <!-- <a href="#" class="inline-block py-2 px-4 rounded font-medium text-white hover:text-[var(--astreinte-vitale-primary)] transition-colors duration-300" style="background: var(--astreinte-vitale-primary)">Lire le cas d'étude</a> -->
        </div>
      </div>

      <div class="flex-none w-full md:w-[calc(50%-1rem)] rounded-lg p-4 md:p-8" style="background: linear-gradient(255.53deg, #0C1431 8.04%, #031121 89.86%);">
        <div class="space-y-8">
          <img src="/assets/images/projects/akanema-logo.jpg" class="h-[76px] w-auto" alt="Logo de la startup Akenema">

          <div class="flex flex-wrap gap-2">
            <span class="bg-[#CE1E1F] text-white px-3 py-1 rounded-full text-sm">HRTech</span>
            <span class="bg-[#CE1E1F] text-white px-3 py-1 rounded-full text-sm">Transformation</span>
            <span class="bg-[#CE1E1F] text-white px-3 py-1 rounded-full text-sm">Soft Skills</span>
          </div>

          <p class="text-white leading-6">
            Identifie les collaborateurs moteurs du changement grâce à leurs soft skills, pour accélérer les projets de transformation et renforcer l’engagement des équipes. Akanema aide les RH et les managers à limiter les freins en s’appuyant sur les bons relais internes, là où les outils seuls ne suffisent plus.
          </p>
        </div>
      </div>

      <div class="flex-none w-full md:w-[calc(50%-1rem)] rounded-lg p-4 md:p-8" style="background: linear-gradient(103.54deg, #61C763 24.06%, #00C289 86.08%);">
        <div class="space-y-8">
          <img src="/assets/images/projects/kwali-logo.svg" class="h-[76px] w-auto" alt="Logo de la startup Kwali">

          <div class="flex flex-wrap gap-2">
            <span class="bg-[#063F5B] text-white px-3 py-1 rounded-full text-sm">SaaS</span>
            <span class="bg-[#063F5B] text-white px-3 py-1 rounded-full text-sm">Automobile</span>
            <span class="bg-[#063F5B] text-white px-3 py-1 rounded-full text-sm">Gestion SAV</span>
          </div>

          <p class="text-white leading-6">
            Le 1er outil de gestion SAV pour les <strong>concessionnaires<span class="faq-tooltip" data-tooltip-theme="kwali">VdL<sup class="faq-tooltip-question-mark">?</sup>
              <template class="faq-tooltip-content">
                <strong class="faq-tooltip-content-title">VdL, <em>Véhicule de loisir</em></strong>
                Un acronyme utilisé dans l'industrie automobile pour désigner des véhicules spécialement conçus pour les loisirs et les activités récréatives, tels que les camping-cars, les caravanes et les fourgons aménagés.
                <br><br>
                Le marché des concessionnaires VdL concerne les professionnels spécialisés dans la vente et la maintenance de ces types de véhicules.
              </template>
            </span></strong>supportant le pilotage opérationnel & stratégique en temps réel d'une activité au coeur de leur métier, pour déployer une qualité de SAV comparable au reste du secteur automobile.
          </p>
        </div>
      </div>

      <div class="flex-none w-full md:w-[calc(50%-1rem)] rounded-lg p-4 md:p-8" style="background: linear-gradient(103.54deg, #16120D 24.06%, #16120D 86.08%);">
        <div class="space-y-8">
          <img src="/assets/images/projects/pmg-estate-logo.jpg" class="h-[76px] w-auto" alt="Logo de la startup PMG Estate">

          <div class="flex flex-wrap gap-2">
            <span class="bg-[#F4F2E7] text-black px-3 py-1 rounded-full text-sm">SaaS</span>
            <span class="bg-[#F4F2E7] text-black px-3 py-1 rounded-full text-sm">Immobilier</span>
            <span class="bg-[#F4F2E7] text-black px-3 py-1 rounded-full text-sm">Marketing digital</span>
          </div>

          <p class="text-white leading-6">
            Le 1er outil de présentation enrichie pour les professionnels de l'immobilier : templates premium, données de quartier, descriptions générées par IA… PMG Estate permet de créer des supports marketing percutants en quelques minutes, sans compétences en design. Pour se démarquer, engager les acheteurs et conclure plus vite.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation controls -->
  <div class="flex justify-center gap-4 mt-8">
    <button
      class="w-10 h-10 rounded-full flex items-center! justify-center! cursor-pointer transition-all duration-300 bg-white/10 hover:bg-white/20 border border-white/20 text-white disabled:opacity-30 disabled:cursor-not-allowed"
      @click="prev()"
      :disabled="currentIndex === 0"
      aria-label="Previous slide">
      ←
    </button>

    <div class="hidden md:flex items-center gap-2">
      <template x-for="(_, index) in [...Array(Math.max(0, totalCards - 1))]" :key="index">
        <button
          class="w-3 h-3 rounded-full transition-colors duration-200 cursor-pointer"
          :class="currentIndex === index ? 'bg-orange-500' : 'bg-gray-400'"
          @click="slideToIndex(index)">
        </button>
      </template>
    </div>

    <button
      class="w-10 h-10 rounded-full flex items-center! justify-center! cursor-pointer transition-all duration-300 bg-white/10 hover:bg-white/20 border border-white/20 text-white disabled:opacity-30 disabled:cursor-not-allowed"
      @click="next()"
      :disabled="isMobile ? currentIndex >= totalCards - 1 : currentIndex >= totalCards - 2"
      aria-label="Next slide">
      →
    </button>
  </div>
</div>
